<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Pointing generation · Harlequin.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>Harlequin.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">Home</a></li><li class="current"><a class="toctext" href>Pointing generation</a><ul class="internal"><li><a class="toctext" href="#ScanningStrategy-1"><code>ScanningStrategy</code></a></li><li><a class="toctext" href="#Pre-defined-scanning-strategies-1">Pre-defined scanning strategies</a></li><li><a class="toctext" href="#Generating-pointings-over-long-periods-of-time-1">Generating pointings over long periods of time</a></li><li><a class="toctext" href="#Loading-and-saving-scanning-strategies-1">Loading and saving scanning strategies</a></li><li><a class="toctext" href="#Pointing-generation-2">Pointing generation</a></li><li><a class="toctext" href="#Utility-functions-1">Utility functions</a></li></ul></li><li><a class="toctext" href="../mapmaking/">Map-making</a></li><li><a class="toctext" href="../examples/">Practical examples</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href>Pointing generation</a></li></ul><a class="edit-page" href="https://github.com/ziotom78/Harlequin.jl/blob/master/docs/src/genpointings.md#L"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Pointing generation</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Pointing-generation-1" href="#Pointing-generation-1">Pointing generation</a></h1><p>One of the most basic facilities provided by CMBMissionSim is the generation of pointing timelines. CMBMissionSim assumes that the spacecraft orbits around the L2 Lagrangean point of the Sun-Earth system, and that it performs a monotonous spin around some axis, optionally with some precession period. This is a quite rigid scheme, but it is the one followed by Planck, CORE, and LiteBIRD.</p><p>The basic object used to create pointings is the <a href="#Harlequin.ScanningStrategy"><code>ScanningStrategy</code></a> structure. You can build a <code>ScanningStrategy</code> object using one of its constructors. The most basic one takes the following syntax:</p><pre><code class="language-julia">ScanningStrategy(;
    spin_rpm = 0,
    prec_rpm = 0,
    yearly_rpm = 1  / (MINUTES_PER_DAY * DAYS_PER_YEAR),
    hwp_rpm = 0,
    spinsunang_rad = deg2rad(45.0),
    borespinang_rad = deg2rad(50.0),
)</code></pre><p>Note that this constructor only takes keywords, and that the measurement units used for them are different from the ones used in the fields in <code>ScanningStrategy</code>. Units in the constructors have been chosen in order to be easy to use, while units in <code>ScanningStrategy</code> allow to make computations more efficient.</p><p>Another kind of constructor allows to load the scanning strategy definition from a JSON file. It comes in two flavours:</p><pre><code class="language-julia"># First version: pass a file object to `ScanningStrategy`
open(&quot;my_scanning_strategy.json&quot;, &quot;r&quot;) do inpf
    sstr = ScanningStrategy(inpf)
end

# Second version (easier): pass the name of the file
sstr = ScanningStrategy(&quot;my_scanning_strategy.json&quot;)</code></pre><p>These JSON files can be created using the function <a href="#Harlequin.save"><code>save</code></a>:</p><pre><code class="language-julia">sstr = ScanningStrategy(spinsunang_rad = deg2rad(35.0))
save(&quot;my_scanning_strategy.json&quot;, sstr)</code></pre><p>If you have loaded the <a href="https://github.com/JuliaPlots/Plots.jl">Plots.jl</a> package, you can produce a rough diagram of the scanning strategy using the <code>plot</code> function on a <code>ScanningStrategy</code> object:</p><pre><code class="language-julia">using Plots
sstr = ScanningStrategy(
    spinsunang_rad = deg2rad(35.0),
    borespinang_rad = deg2rad(40.0),
)
plot(sstr)</code></pre><pre><code class="language-none">/home/travis/.julia/packages/GR/ZI5OE/src/../deps/gr/bin/gksqt: error while loading shared libraries: libQt5Widgets.so.5: cannot open shared object file: No such file or directory
connect: Connection refused
GKS: can&#39;t connect to GKS socket application
Did you start &#39;gksqt&#39;?

GKS: Open failed in routine OPEN_WS
GKS: GKS not in proper state. GKS must be either in the state WSOP or WSAC in routine ACTIVATE_WS</code></pre><p><img src="../sstr_plot.svg" alt/></p><p>(Conventionally, the angle between the spin axis and the Sun-Spacecraft direction is indicated with the symbol α, and the angle between the boresight direction and the spin axis with β.)</p><p>Once you have a <a href="#Harlequin.ScanningStrategy"><code>ScanningStrategy</code></a> object, you generate the sequence of pointing directions through one of the following functions:</p><ul><li><code>genpointings</code> and <code>genpointings!</code> generate a set of pointing directions that encompass a range of time; most of the time you will use this.</li><li><code>time2pointing</code> and <code>time2pointing!</code> generate one pointing direction at a time; they are useful if you are working on a system with limited memory resources.</li></ul><p>The version with the <code>!</code> and the end save their result in a preallocated block, while the other ones use the return value of the function. The former is useful if you are using some strategy to pre-allocate memory in order to optimize running times. For instance, the following code is not optimal, as <code>genpointings</code> is re-creating the same result matrix over and over again:</p><pre><code class="language-julia">const SECONDS_IN_A_HOUR = 3600.
sstr = ScanningStrategy()
start_time = 0.0
# Simulate an observation lasting 1000 hours
for hour_num in 1:1000
    # Each call to &quot;genpointings&quot; allocates a new &quot;pnt&quot; matrix:
    # doing it multiple times like in this &quot;for&quot; loop takes time and
    # slows down the execution!
    pnt = genpointings(sstr, start_time:(start_time + SECONDS_IN_A_HOUR),
        Float64[0, 0, 1], 0.0)
    # Use &quot;pnt&quot; here
    # ...
end</code></pre><p>The code below is more efficient, as the allocation is done only once:</p><pre><code class="language-julia">const SECONDS_IN_A_HOUR = 3600.
sstr = ScanningStrategy()
start_time = 0.0

# Allocate this variable once and for all
pnt = Array{Float64}(undef, SECONDS_IN_A_HOUR, 6)

# Simulate an observation lasting 1000 hours
for hour_num in 1:1000
    # Use &quot;pnt&quot; again and again, overwriting it each time: this is
    # much faster!
    genpointings!(sstr, start_time:(start_time + SECONDS_IN_A_HOUR),
        Float64[0, 0, 1], 0.0, pnt)
    # Use &quot;pnt&quot; here
    # ...
end</code></pre><h2><a class="nav-anchor" id="ScanningStrategy-1" href="#ScanningStrategy-1"><code>ScanningStrategy</code></a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Harlequin.ScanningStrategy" href="#Harlequin.ScanningStrategy"><code>Harlequin.ScanningStrategy</code></a> — <span class="docstring-category">Type</span>.</div><div><div><p>The structure <code>ScanningStrategy</code> encodes the information needed to build a set of pointing directions. It contains the following fields:</p><ul><li><code>omega_spin_hz</code>: angular speed of the rotation around the spin axis (equal to 2πν)</li><li><code>omega_prec_hz</code>: angular speed of the rotation around the precession axis (equal to 2πν)</li><li><code>omega_year_hz</code>: angular speed of the rotation around the Elliptic axis (equal to 2πν)</li><li><code>omega_hwp_hz</code>: angular speed of the rotation of the half-wave plate (equal to 2πν)</li><li><code>spinsunang_rad</code>: angle between the spin axis and the Sun-Earth direction</li><li><code>borespinang_rad</code>: angle between the boresight direction and the spin axis</li><li><code>q1</code>, <code>q3</code>: quaternions used to generate the pointings</li></ul><p>Each field has its measure unit appended to the name. For instance, field <code>spinsunang_rad</code> must be expressed in radians.</p></div></div><a class="source-link" target="_blank" href="https://github.com/ziotom78/Harlequin.jl/blob/b5afa1af0448337beb49b24df18aebb23234d872/src/genpointings.jl#LL59-L74">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Harlequin.update_scanning_strategy" href="#Harlequin.update_scanning_strategy"><code>Harlequin.update_scanning_strategy</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">update_scanning_strategy(sstr::ScanningStrategy)</code></pre><p>Update the internal fields of a <code>ScanningStrategy</code> object. If you change any of the fields in a <code>ScanningStrategy</code> object after it has been created using the constructors, call this function before using one of the functions <code>time2pointing</code>, <code>time2pointing!</code>, <code>genpointings</code>, and <code>genpointings!</code>, as they rely on a number of internal parameters that need to be updated.</p><pre><code class="language-julia">sstr = ScanningStrategy()
# ... use sstr ...

sstr.borespinang_rad *= 0.5
update_scanning_strategy(sstr)</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/ziotom78/Harlequin.jl/blob/b5afa1af0448337beb49b24df18aebb23234d872/src/genpointings.jl#LL109-L127">source</a></section><h2><a class="nav-anchor" id="Pre-defined-scanning-strategies-1" href="#Pre-defined-scanning-strategies-1">Pre-defined scanning strategies</a></h2><p>Harlequin includes a few constants for the scanning strategies used by notable CMB proposals.</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Harlequin.CORE_SCANNING_STRATEGY" href="#Harlequin.CORE_SCANNING_STRATEGY"><code>Harlequin.CORE_SCANNING_STRATEGY</code></a> — <span class="docstring-category">Constant</span>.</div><div><div><pre><code class="language-julia">CORE_SCANNING_STRATEGY::ScanningStrategy</code></pre><p>A <a href="#Harlequin.ScanningStrategy"><code>ScanningStrategy</code></a> object describing the proposed scanning strategy of the CORE spacecraft (<a href="https://doi.org/10.1088/1475-7516/2018/04/014">Delabrouille et al., 2018</a>).</p></div></div><a class="source-link" target="_blank" href="https://github.com/ziotom78/Harlequin.jl/blob/b5afa1af0448337beb49b24df18aebb23234d872/src/genpointings.jl#LL139-L146">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Harlequin.PICO_SCANNING_STRATEGY" href="#Harlequin.PICO_SCANNING_STRATEGY"><code>Harlequin.PICO_SCANNING_STRATEGY</code></a> — <span class="docstring-category">Constant</span>.</div><div><div><pre><code class="language-julia">PICO_SCANNING_STRATEGY::ScanningStrategy</code></pre><p>A <a href="#Harlequin.ScanningStrategy"><code>ScanningStrategy</code></a> object describing the proposed scanning strategy of the PICO spacecraft (<a href="https://ui.adsabs.harvard.edu/abs/2019arXiv190210541H/abstract">Hanany et al., 2019</a>).</p></div></div><a class="source-link" target="_blank" href="https://github.com/ziotom78/Harlequin.jl/blob/b5afa1af0448337beb49b24df18aebb23234d872/src/genpointings.jl#LL157-L164">source</a></section><h2><a class="nav-anchor" id="Generating-pointings-over-long-periods-of-time-1" href="#Generating-pointings-over-long-periods-of-time-1">Generating pointings over long periods of time</a></h2><p>Harlequin provides an handy structure, <code>SegmentedTimeSpan</code>, which can be used to produce the time ranges required by <a href="#Harlequin.genpointings"><code>genpointings</code></a> and <a href="#Harlequin.genpointings!"><code>genpointings!</code></a> in a <em>segmented</em> fashion.</p><p>Suppose you want to simulate the behavior of a spacecraft over one year. As the sampling frequency of the detector is small, one tenth of a second, the pointing matrix returned by <a href="#Harlequin.genpointings"><code>genpointings</code></a> is going to be huge. Usually there is no need to keep all the pointing matrix at once; typically what you want to keep is the pixel index for each sample and the polarisation angle.</p><p>In this case, you can divide the overall time span (one year) into small segments and process one of them at a time, using <code>SegmentedTimeSpan</code>. The following example shows the idea: we simulate one day of observations one hour at a time.</p><pre><code class="language-julia">sts = SegmentedTimeSpan(
    start_time = 0.0,
    sampling_time = 0.1,
    segment_duration = 3600,  # One hour
    num_of_segments = 24,     # One day of observations
)

# Each element of the &quot;sts&quot; array is the sequence of time samples
# for one day

# Size the pointing matrix according to the first day
pointings = Array{Float64}(undef, length(sts[1]), 6)

for (hour_number, cur_time_span) in enumerate(sts)
    println(&quot;Processing hour #$hour_number, time samples are $cur_time_span&quot;)
    genpointings!(
        PICO_SCANNING_STRATEGY,
        cur_time_span,
        Float64[0, 0, 1],
        0.0,
        pointings,
    )

    # &quot;pointings&quot; contains the pointings for the current hour
end</code></pre><pre><code class="language-none">Processing hour #1, time samples are 0.0:0.1:3599.9
Processing hour #2, time samples are 3600.0:0.1:7199.9
Processing hour #3, time samples are 7200.0:0.1:10799.9
Processing hour #4, time samples are 10800.0:0.1:14399.9
Processing hour #5, time samples are 14400.0:0.1:17999.9
Processing hour #6, time samples are 18000.0:0.1:21599.9
Processing hour #7, time samples are 21600.0:0.1:25199.9
Processing hour #8, time samples are 25200.0:0.1:28799.9
Processing hour #9, time samples are 28800.0:0.1:32399.9
Processing hour #10, time samples are 32400.0:0.1:35999.9
Processing hour #11, time samples are 36000.0:0.1:39599.9
Processing hour #12, time samples are 39600.0:0.1:43199.9
Processing hour #13, time samples are 43200.0:0.1:46799.9
Processing hour #14, time samples are 46800.0:0.1:50399.9
Processing hour #15, time samples are 50400.0:0.1:53999.9
Processing hour #16, time samples are 54000.0:0.1:57599.9
Processing hour #17, time samples are 57600.0:0.1:61199.9
Processing hour #18, time samples are 61200.0:0.1:64799.9
Processing hour #19, time samples are 64800.0:0.1:68399.9
Processing hour #20, time samples are 68400.0:0.1:71999.9
Processing hour #21, time samples are 72000.0:0.1:75599.9
Processing hour #22, time samples are 75600.0:0.1:79199.9
Processing hour #23, time samples are 79200.0:0.1:82799.9
Processing hour #24, time samples are 82800.0:0.1:86399.9</code></pre><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Harlequin.SegmentedTimeSpan" href="#Harlequin.SegmentedTimeSpan"><code>Harlequin.SegmentedTimeSpan</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-julia">struct SegmentedTimeSpan</code></pre><p>An immutable structure representing a long time span, split into units of equal length called <em>segments</em>. This structure is typically used to make consecutive calls to <a href="#Harlequin.genpointings!"><code>genpointings!</code></a> and <a href="#Harlequin.genpointings"><code>genpointings</code></a>.</p><p>The fields are the following:</p><ul><li><code>start_time</code> is the time of the first sample in the time span</li><li><code>sampling_time</code> is the integration time for one sample</li><li><code>segment_duration</code> is the duration of one segment</li><li><code>num_of_segments</code> is the number of segments in the time span</li></ul><p>The following example defines a time span of 1 year as the composition of multiple spans, each lasting one day:</p><pre><code class="language-julia">sts = SegmentedTimeSpan(
    start_time = 0.0,
    sampling_time = 0.1,
    segment_duration = 24 * 3600,
    num_of_segments = 365,
)</code></pre><p>Once a <code>SegmentedTimeSpan</code> has been constructed, it behaves like an array, whose elements are time ranges of type <code>StepRangeLen</code>. You can iterate over it, to run functions like <a href="#Harlequin.genpointings"><code>genpointings</code></a>:</p><pre><code class="language-julia">for cur_time_span in sts
    pointings = genpointings(PICO_SCANNING_STRATEGY, cur_time_span, ...)

    # &quot;pointings&quot; contain the pointings for the time span
end</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/ziotom78/Harlequin.jl/blob/b5afa1af0448337beb49b24df18aebb23234d872/src/genpointings.jl#LL527-L566">source</a></section><h2><a class="nav-anchor" id="Loading-and-saving-scanning-strategies-1" href="#Loading-and-saving-scanning-strategies-1">Loading and saving scanning strategies</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Harlequin.load_scanning_strategy" href="#Harlequin.load_scanning_strategy"><code>Harlequin.load_scanning_strategy</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">load_scanning_strategy(io::IO) -&gt; ScanningStrategy
load_scanning_strategy(filename::AbstractString) -&gt; ScanningStrategy</code></pre><p>Create a <code>ScanningStrategy</code> object from the definition found in the JSON file <code>io</code>, or from the JSON file with path <code>filename</code>. See also <a href="#Harlequin.load_scanning_strategy"><code>load_scanning_strategy</code></a>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/ziotom78/Harlequin.jl/blob/b5afa1af0448337beb49b24df18aebb23234d872/src/genpointings.jl#LL193-L201">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Harlequin.to_dict" href="#Harlequin.to_dict"><code>Harlequin.to_dict</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">to_dict(sstr::ScanningStrategy) -&gt; Dict{String, Any}</code></pre><p>Convert a scanning strategy into a dictionary suitable to be serialized using JSON or any other structured format. See also <a href="#Harlequin.save"><code>save</code></a>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/ziotom78/Harlequin.jl/blob/b5afa1af0448337beb49b24df18aebb23234d872/src/genpointings.jl#LL206-L212">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Harlequin.save" href="#Harlequin.save"><code>Harlequin.save</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">save(io::IO, sstr::ScanningStrategy)
save(filename::AbstractString, sstr::ScanningStrategy)</code></pre><p>Write a definition of the scanning strategy in a self-contained JSON file. You can reload this definition using one of the constructors of <a href="#Harlequin.ScanningStrategy"><code>ScanningStrategy</code></a>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/ziotom78/Harlequin.jl/blob/b5afa1af0448337beb49b24df18aebb23234d872/src/genpointings.jl#LL232-L240">source</a></section><h2><a class="nav-anchor" id="Pointing-generation-2" href="#Pointing-generation-2">Pointing generation</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Harlequin.time2pointing" href="#Harlequin.time2pointing"><code>Harlequin.time2pointing</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">time2pointing!(sstr::ScanningStrategy, time_s, beam_dir, polangle_rad, resultvec)
time2pointing(sstr::ScanningStrategy, time_s, beam_dir, polangle_rad)</code></pre><p>Calculate the pointing direction of a beam along the direction <code>beam_dir</code>, with a detector sensitive to the polarization along the angle <code>polangle_rad</code>. The result is saved in <code>resultvec</code> for <code>time2pointing!</code>, and it is the return value of <code>time2pointing</code>; it is a 6-element array containing the following fields:</p><ol><li>The colatitude (in radians) of the point in the sky</li><li>The longitude (in radians) of the point in the sky</li><li>The polarization angle, in the reference frame of the sky</li><li>The X component of the normalized pointing vector</li><li>The Y component</li><li>The Z component</li></ol><p>Fields #4, #5, #6 are redundant, as they can be derived from the colatitude (field #1) and longitude (field #2). They are returned as the code already computes them.</p><p>The vector <code>beam_dir</code> and the angle <code>polangle_rad</code> must be expressed in the reference system of the focal plane. If <code>polangle_rad == 0</code>, the detector measures polarization along the x axis of the focal plane. The normal direction to the focal plane is along the z axis; thus, the boresight director is such that <code>beam_dir = [0., 0., 1.]</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/ziotom78/Harlequin.jl/blob/b5afa1af0448337beb49b24df18aebb23234d872/src/genpointings.jl#LL449-L475">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Harlequin.time2pointing!" href="#Harlequin.time2pointing!"><code>Harlequin.time2pointing!</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">time2pointing!(sstr::ScanningStrategy, time_s, beam_dir, polangle_rad, resultvec)
time2pointing(sstr::ScanningStrategy, time_s, beam_dir, polangle_rad)</code></pre><p>Calculate the pointing direction of a beam along the direction <code>beam_dir</code>, with a detector sensitive to the polarization along the angle <code>polangle_rad</code>. The result is saved in <code>resultvec</code> for <code>time2pointing!</code>, and it is the return value of <code>time2pointing</code>; it is a 6-element array containing the following fields:</p><ol><li>The colatitude (in radians) of the point in the sky</li><li>The longitude (in radians) of the point in the sky</li><li>The polarization angle, in the reference frame of the sky</li><li>The X component of the normalized pointing vector</li><li>The Y component</li><li>The Z component</li></ol><p>Fields #4, #5, #6 are redundant, as they can be derived from the colatitude (field #1) and longitude (field #2). They are returned as the code already computes them.</p><p>The vector <code>beam_dir</code> and the angle <code>polangle_rad</code> must be expressed in the reference system of the focal plane. If <code>polangle_rad == 0</code>, the detector measures polarization along the x axis of the focal plane. The normal direction to the focal plane is along the z axis; thus, the boresight director is such that <code>beam_dir = [0., 0., 1.]</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/ziotom78/Harlequin.jl/blob/b5afa1af0448337beb49b24df18aebb23234d872/src/genpointings.jl#LL449-L475">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Harlequin.genpointings" href="#Harlequin.genpointings"><code>Harlequin.genpointings</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">genpointings!(sstr::ScanningStrategy, timerange_s, beam_dir, polangle_rad, result)
genpointings(sstr::ScanningStrategy, timerange_s, beam_dir, polangle_rad)</code></pre><p>Generate a set of pointing directions and angles for a given orientation <code>beam_dir</code> (a 3-element vector) of the boresight beam, assuming the scanning strategy in <code>sstr</code>. The pointing directions are calculated over all the elements of the list <code>timerange_s</code>. The angle <code>polangle_rad</code> is the value of the polarization angle at time <span>$t = 0$</span>.</p><p>The two functions only differ in the way the result is returned to the caller. Function <code>genpointings</code> returns a N×6 matrix containing the following fields:</p><ol><li>The colatitude (in radians)</li><li>The longitude (in radians)</li><li>The polarization angle (in radians)</li><li>The X component of the one-length pointing vector</li><li>The Y component</li><li>The Z component</li></ol><p>Function <code>genpointings!</code> works like <code>genpointings</code>, but it accept a pre-allocated matrix as input (the <code>result</code> parameter) and will save the result in it. The matrix must have two dimensions with size <code>(N, 6)</code> at least.</p><p>Both functions are simple iterators wrapping <a href="#Harlequin.time2pointing!"><code>time2pointing!</code></a> and <a href="#Harlequin.time2pointing"><code>time2pointing</code></a>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/ziotom78/Harlequin.jl/blob/b5afa1af0448337beb49b24df18aebb23234d872/src/genpointings.jl#LL495-L522">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Harlequin.genpointings!" href="#Harlequin.genpointings!"><code>Harlequin.genpointings!</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">genpointings!(sstr::ScanningStrategy, timerange_s, beam_dir, polangle_rad, result)
genpointings(sstr::ScanningStrategy, timerange_s, beam_dir, polangle_rad)</code></pre><p>Generate a set of pointing directions and angles for a given orientation <code>beam_dir</code> (a 3-element vector) of the boresight beam, assuming the scanning strategy in <code>sstr</code>. The pointing directions are calculated over all the elements of the list <code>timerange_s</code>. The angle <code>polangle_rad</code> is the value of the polarization angle at time <span>$t = 0$</span>.</p><p>The two functions only differ in the way the result is returned to the caller. Function <code>genpointings</code> returns a N×6 matrix containing the following fields:</p><ol><li>The colatitude (in radians)</li><li>The longitude (in radians)</li><li>The polarization angle (in radians)</li><li>The X component of the one-length pointing vector</li><li>The Y component</li><li>The Z component</li></ol><p>Function <code>genpointings!</code> works like <code>genpointings</code>, but it accept a pre-allocated matrix as input (the <code>result</code> parameter) and will save the result in it. The matrix must have two dimensions with size <code>(N, 6)</code> at least.</p><p>Both functions are simple iterators wrapping <a href="#Harlequin.time2pointing!"><code>time2pointing!</code></a> and <a href="#Harlequin.time2pointing"><code>time2pointing</code></a>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/ziotom78/Harlequin.jl/blob/b5afa1af0448337beb49b24df18aebb23234d872/src/genpointings.jl#LL495-L522">source</a></section><h2><a class="nav-anchor" id="Utility-functions-1" href="#Utility-functions-1">Utility functions</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Harlequin.rpm2angfreq" href="#Harlequin.rpm2angfreq"><code>Harlequin.rpm2angfreq</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">rpm2angfreq(rpm)
angfreq2rpm(ω)</code></pre><p>Convert rotations per minute into angular frequency 2πν (in Hertz), and vice versa.</p></div></div><a class="source-link" target="_blank" href="https://github.com/ziotom78/Harlequin.jl/blob/b5afa1af0448337beb49b24df18aebb23234d872/src/genpointings.jl#LL33-L39">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Harlequin.angfreq2rpm" href="#Harlequin.angfreq2rpm"><code>Harlequin.angfreq2rpm</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">rpm2angfreq(rpm)
angfreq2rpm(ω)</code></pre><p>Convert rotations per minute into angular frequency 2πν (in Hertz), and vice versa.</p></div></div><a class="source-link" target="_blank" href="https://github.com/ziotom78/Harlequin.jl/blob/b5afa1af0448337beb49b24df18aebb23234d872/src/genpointings.jl#LL33-L39">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Harlequin.period2rpm" href="#Harlequin.period2rpm"><code>Harlequin.period2rpm</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">period2rpm(p)
rpm2perriod(rpm)</code></pre><p>Convert a period (time span) in seconds into a number of rotations per minute, and vice versa.</p></div></div><a class="source-link" target="_blank" href="https://github.com/ziotom78/Harlequin.jl/blob/b5afa1af0448337beb49b24df18aebb23234d872/src/genpointings.jl#LL45-L51">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Harlequin.rpm2period" href="#Harlequin.rpm2period"><code>Harlequin.rpm2period</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">period2rpm(p)
rpm2perriod(rpm)</code></pre><p>Convert a period (time span) in seconds into a number of rotations per minute, and vice versa.</p></div></div><a class="source-link" target="_blank" href="https://github.com/ziotom78/Harlequin.jl/blob/b5afa1af0448337beb49b24df18aebb23234d872/src/genpointings.jl#LL45-L51">source</a></section><footer><hr/><a class="previous" href="../"><span class="direction">Previous</span><span class="title">Home</span></a><a class="next" href="../mapmaking/"><span class="direction">Next</span><span class="title">Map-making</span></a></footer></article></body></html>
